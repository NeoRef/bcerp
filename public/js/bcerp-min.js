$(document).foundation({accordion:{multi_expand:true}});$("#results-modal").foundation("reveal","open");var BCERP=(function(c,b){var a={};function d(){var g=c("form");var e=c("#skip-button").attr("href");var h=c("<a></a>").attr("id","next-button").attr("href",e).addClass("button small radius").html("Next &raquo;");var f=g.find('button[type="submit"]').replaceWith(h);c.ajax({url:b.location.href,type:"POST",data:g.serialize(),success:function(k,l,i){if(k.status!=true){h.replaceWith(f)}else{var j=k.progress;c("#progress-meter").css("width",j+"%");c("#percent-complete").text(j+"% done")}},error:function(i,k,j){h.replaceWith(f)}})}a.init=function(){a.bindQuestionAnswerEvents();a.bindCloseResultsModalEvent();if(typeof logQuestionnaireFinished!="undefined"&&logQuestionnaireFinished){BCERP.ANALYTICS.logQuestionnaireIsFinished()}c("#shareable-url").on("focus, click",function(){this.select()})};a.bindCloseResultsModalEvent=function(){c("#results-modal .close").on("click",function(f){f.preventDefault();c("#results-modal").foundation("reveal","close");c.ajax({url:c(this).attr("href"),type:"GET"})})};a.bindQuestionAnswerEvents=function(){c(".question input, .question select").filter(":not(#question-6, #question-7)").on("change",function(){d();var g=c(this);var f=c("#risk-message");var h=g.data("risk");g.parents("fieldset").removeClass("unanswered");if(this.nodeName.toLowerCase()=="select"){h=g.find(":selected").data("risk")}if(h=="higher-risk"){f.html(riskMessages["higher-risk"])}else{if(h=="lower-risk"){f.html(riskMessages["lower-risk"])}else{f.empty()}}if(h!="no-risk"){f.css("background","#FFFF6B").stop().animate({backgroundColor:"transparent"},1500)}});c("#question-6, #question-7").on("change",function(){var f=c(this);f.find(":selected").data("selected",true);e()});function e(i){var k=null;var g=null;var f=null;var l=null;var j=null;var h=c("#risk-message");f=c("#question-6 :selected").data("value");l=c("#question-7 :selected").data("value");heightUpdatedByUser=BCERP.UTILS.isDefined(c("#question-6 :selected").data("selected"));weightUpdatedByUser=BCERP.UTILS.isDefined(c("#question-7 :selected").data("selected"));if(heightUpdatedByUser&&weightUpdatedByUser&&BCERP.UTILS.isDefined(f)&&BCERP.UTILS.isDefined(l)){d();k=BCERP.UTILS.calculateBmi(l,f);g=BCERP.UTILS.convertBmiToStatus(k);if(k>=25){j=c(riskMessages["higher-risk"])}else{j=c(riskMessages["lower-risk"])}j.find("span").after(" Your BMI is "+k+".");h.html(j);h.css("background","#FFFF6B").stop().animate({backgroundColor:"transparent"},1500)}}};return a})(jQuery,window);BCERP.UTILS=(function(){var a={};a.isDefined=function(b){return !(typeof b==="undefined"||b===null||b==="")};a.convertBmiToStatus=function(b){if(b<18.5){return"Underweight"}else{if(b>=18.5&&b<=24.9){return"Normal"}else{if(b>=25&&b<=29.9){return"Overweight"}else{return"Obese"}}}};a.calculateBmi=function(b,c){return((b/Math.pow(c,2))*703).toFixed(2)};return a})();BCERP.ANALYTICS=(function(){var a={};a.logQuestionnaireIsFinished=function(){_gaq.push(["_setCustomVar",1,"Questionnaire Complete","True",1])};return a})();BCERP.init();